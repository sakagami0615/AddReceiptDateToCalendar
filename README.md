# **AddReceiptDateToCalendar**

## **1.ツール概要**

Amazonで商品を購入した際に届くメールを確認し、お届け日をGoogleカレンダーの予定に追加します。<br>
(Google Apps Scriptを使用)

![tool-img](https://github.com/sakagami0615/AddReceiptDateToCalendar/raw/image/img/tool.png)
※メールとカレンダーの日付がずれていますが、気にしないでください…

<br>

## **2.前提条件**

本ツールを使用する際は下記の条件をクリアする必要があります。

+ Amazonのアカウントに登録しているメールがGMailであること。
+ 注文時に届くメールを迷惑メールに設定していたり、受信トレイをスキップしていないこと。
+ Googleカレンダーを常用していること。

<br>

## **3.準備**

+ Googleアカウントにログインしていない場合は、ログインする。
+ Google Apps Scriptのページにアクセスする。（検索すれば出てきます）
+ 「新しいプロジェクト」を作成する。（名前は好きなものに変えてもらってかまいません）
+ 「コード.gs」に記載されているコードをいったん削除する。
+ 削除した後、本リポジトリにある「main.gs」のコードをコピペする。
+ デバックボタンの隣にあるプルダウン「AddReceiptDateToCalendar」を選択する。
+ 実行をクリックすると、承認の要求が来るはずなので、許可する。<br>
そのあとにGMailとGoogleカレンダーに関する要求も来るはずなので、許可する。
+ トリガー（時計のマーク）から「トリガーを追加」をクリック。
+ 下記のように設定し、保存する。
    + 実行する関数：AddReceiptDateToCalendar
    + イベントのソース：時間主導型
    + 時間ベースのトリガータイプ：時間ベースのタイマー
    + 時間の間隔：1時間おき（ここの設定は任意で変えても問題ない）
    + ※その他はデフォルトでOK

時間の間隔で設定した時間おきにGoogle Apps Scriptが作動します。<br>
※つまり、このツールはメールの受信をトリガーにしているわけではないのです…<br>

ちなみに一回の処理で20件のメールを捌けるので、1時間内に20件以上の注文をする場合があれば、もっと短い時間に設定するのが良いと思います。

<br>

## **4.補足**

「main.gs」のコードの上の方にある「IS_DEBUG」と「ADD_CALENDER」はデバック用に使用していた変数だが、<br>
「MOVE_ARCHIVE」は要確認したほうが良いだろう。<br>

```javascript
// 処理実施後のメールをアーカイブへ移動させる機能の切り替えフラグ
// true : 処理後のメールはアーカイブに移動させる
// false: 処理後のメールはアーカイブに移動させない
const MOVE_ARCHIVE = true;
```
※GMailのアーカイブを活用していない人は[false]にしておくのがいいかも？
